---
title: "Quem são os mais ricos (parte 2)?"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(dplyr)
library(devtools)
library(DT)
library(flexdashboard)
library(knitr)
library(ggplot2)
library(rCharts)
library(reshape2)
require(scales)
library(shiny)
library(plotly)
library(tidyverse)


#######################################################################################################
#Autor: Ítalo de Pontes Oliveira e Leandro Balby Marinho                                              #
#Os CSV's são gerados mensalmente, assim, para cada arquivo de dados, uma nova variável é atribuida   #
#######################################################################################################
data_filename = "/home/italo/workspace/dados_senado.csv"

#######################################################################################################
#Por convensão, decidiu-se utilizar o formato de arquivo CSV, logo o separador sempre será a vírgula  #
#######################################################################################################
data <- read.csv2(file=data_filename, sep=",", header=FALSE, stringsAsFactors=FALSE, na.strings="unknown", dec=".")
colnames(data) <-  c("id","nome","vinculo","situacao","ano_de_admissao","cargo","padrao","especialidade","mes","ano","remuneracao_basica","vantagens_pessoais","funcao_comissao","gratificacao_natalina","horas_extras","outras_remuneracoes","adicional_periculosidade","adicional_noturno","abono_permanencia","reversao","imposto_de_renda","psss","faltas","remuneracao_apos_descontos","diarias","auxilios","auxilio_alimentacao","vantagens_indenizatorias","adicional_ferias","ferias_indenizatorias","licenca_premio","remuneracao_basica_s","vantagens_pessoais_s","funcao_comissao_s","gratificacao_natalina_s","horas_extras_s","outras_remuneracoes_s","adicional_periculosidade_s","adicional_noturno_s","abono_permanencia_s","reversao_s","imposto_de_renda_s","psss_s","faltas_s","remuneracao_apos_descontos_s","diarias_s","auxilios_s","auxilio_alimentacao_s","vantagens_indenizatorias_s","adicional_ferias_s","ferias_indenizatorias_s","licenca_premio_s")

data <- mutate(data, remuneracao_total=remuneracao_basica + vantagens_pessoais + funcao_comissao + gratificacao_natalina + horas_extras + outras_remuneracoes + abono_permanencia + reversao + imposto_de_renda + psss + faltas + diarias + auxilios + vantagens_indenizatorias)
data <- mutate(data, remuneracao_total_s=remuneracao_basica_s + vantagens_pessoais_s + funcao_comissao_s + gratificacao_natalina_s + horas_extras_s + outras_remuneracoes_s + abono_permanencia_s + reversao_s + imposto_de_renda_s + psss_s + faltas_s + diarias_s + auxilios_s + vantagens_indenizatorias_s)
data <- mutate(data, remuneracao_total_liquida=remuneracao_total+remuneracao_total_s)

ano_max <- max(data$ano)
ano_min <- min(data$ano)

options(scipen=999, OutDec= ",")

senado_recente <- data[data$ano==ano_max,]

remuneracao_total_liquida <- sum(data$remuneracao_total_liquida, na.rm=T)


topSalarios <- function(salariosAgregados, column_ref, keeps, size) {
  topSalarios <- salariosAgregados[order(column_ref, decreasing=TRUE)[1:size],]
  rownames(topSalarios) <- NULL
  colnames(topSalarios) <- keeps
  return(topSalarios)
}

keeps <- c("Nome","Cargo","Especialidade","Situação","Mês","Ano","Ano de Admissão","Licença-Prêmio* (R$)")
salariosAgregados <- aggregate(licenca_premio_s~nome+cargo+especialidade+situacao+mes+ano+ano_de_admissao, FUN=sum, data)
top_servidores_licenca_premio <- topSalarios(salariosAgregados, salariosAgregados$licenca_premio_s, keeps, 10)

gasto_de_referencia <- sum(top_servidores_licenca_premio$`Licença-Prêmio* (R$)`)

```

**Para se ter ideia dos gastos do Senado com folha de pagamento dos servidores, só em `r ano_max`, o que foi pago em Licença-Prêmio para apenas dez servidores seria equivalente à:**

Row
-----------------------------------------------------------------------

### ambulancia

```{r custo_de_uma_ambulancia}
valor_de_uma_ambulancia <- 150600
value <- round(gasto_de_referencia/valor_de_uma_ambulancia, 0)
valueBox(value, caption="Ambulâncias novas", icon = "fa-car", color="primary", href="http://www.otempo.com.br/cidades/dezenove-ambul%C3%A2ncias-do-samu-est%C3%A3o-paradas-em-galp%C3%A3o-1.1436254")
```

### bolsas doutorado

```{r bolsa_capes_doutorado}
bolsa_doutorado <- 2200
value <- round(gasto_de_referencia/(bolsa_doutorado*48), 0)
valueBox(value, caption="Alunos de doutorado com Bolsa CAPES por 4 anos", icon = "fa-pencil", color="#2a6592", href="http://www.capes.gov.br/bolsas/valores-de-bolsas")
```

### tratamento cancer

```{r tratamento_cancer}
paciente_cancer <- 10476
value <- round(gasto_de_referencia/paciente_cancer, 0)
valueBox(value, caption="Atendimentos à pacientes com Câncer", icon = "fa-medkit", color="primary", href="http://www2.inca.gov.br/wps/wcm/connect/agencianoticias/site/home/noticias/2016/ministro-da-saude-anuncia-prioridades-para-a-oncologia")
```

### merenda escolar

```{r meses_merenda_escolar}
valor_merenda <- 11.34
value <- paste(round(gasto_de_referencia/(valor_merenda*10^3), 1), " Mil")
valueBox(value, caption="Crianças beneficiadas com merenda escolar", icon = "fa-cutlery", color="#2a6592", href="http://agenciabrasil.ebc.com.br/politica/noticia/2017-02/governo-anuncia-reajustes-para-merenda-escolar")
```

### domestica aposentadoria

```{r domestica_aposentadoria}
domestica_inss <- 120
value <- paste(round(gasto_de_referencia/(domestica_inss*10^3), 1), "Mil")
valueBox(value, caption="Domésticas contribuindo para o INSS", icon = "fa-home", color="primary", href="https://www.domesticalegal.com.br/utilidades/tabela-de-inss/")
```

### asfaltar rodovias

```{r asfaltar_rodovias}
rodovia_quilometro <- 3468000
value <- round(gasto_de_referencia/rodovia_quilometro, 1)
valueBox(value, caption="Quilomêtros de rodovias asfaltadas", icon = "fa-road", color="#2a6592", href="https://189.9.128.64/download/servicos/custo-medio-gerencial/custos-medios-ger.novembro-14.pdf")
```


## Análise do Senado {.tabset .tabset-fade}

### Gastos do Senado

Nós extraimos a folha de pagamento do Senado para um total de `r round(nrow(data)/10^3, 0)` mil empenhos de pagamento entre os anos de `r ano_min` e `r ano_max`. Desse total, só em `r ano_max` foram `r round(nrow(senado_recente)/10^3, 0)` mil pagamentos o que corresponde a `r  round(nrow(senado_recente)/nrow(data)*100,1)`% de todos os pagamentos nesse período.

O total de gastos com a folha do Senado nesse período está na ordem de R$ `r round(remuneracao_total_liquida/10^9, 2)` bilhões de reais com uma média de R$ `r format(remuneracao_total_liquida/nrow(data), big.mark='.',decimal.mark=',',digits=2)` por servidor, já inclusos todos os descontos como o imposto de renda, Plano de Seguridade Social do Servidor Público (PSSS), reversão do teto constitucional e eventuais ausências.

* **Como é calculada a remuneração dos servidores?**

Para entender a remuneração dos servidores da folha do Senado é importante observar que cada servidor (ou a maioria deles) possui duas folhas de pagamento: a *normal* e a *suplementar*. Para cada folha de pagamento existem os seguintes campos de pagamento:

- **Estrutura Remuneratória Básica**
- **Vantagens Pessoais**
- **Vantagens Eventuais**: Função Comissionada, Antecipação e Gratificação Natalina, Horas Extras e Outras Remunerações Eventuais/Provisórias.
- **Abono de Permanência**
- **Descontos Obrigatórios**: Reversão do Teto Constitucional, Imposto de Renda, PSSS e Faltas.
- **Vantagens Indenizatórias e Compensatórias**: Diárias, Auxílios (Auxílio-Alimentação) e Outras Vantagens Indenizatórias (Férias Indenizadas (proporcionais), Licença-prêmio convertida em pecúnia - aposentado, Adicional de Férias Proporcionais Indenizadas e Férias Indenizadas).
- **Remuneração Após Descontos Obrigatórios**: Corresponde à remuneração líquida do servidor que corresponde a remuneração básica mais as complementares menos os descontos. De forma mais precisa:
**Remuneração Líquia = Remuneração Básica + Vantagens Pessoais + Função Comissão + Gratificação Natalina + Horas Extras + Outras Remunerações + Abono Permanência - Reversão ao Teto Constitucional - Imposto de Renda - PSSS - Faltas + Diárias + Auxílios + Vantagens Indenizatórias**

Na maioria das análises que fizemos usamos a remuneração líquida do servidor.

-----------------------------------------------------------------------

* **O que gastamos com Licença-Prêmio daria para adquirir:**

Para se ter uma ideia dos elevados gastos do Senado com remuneração dos servidores, resolvemos destacar o que seria possível investir utilizando o pagamento de licença-prêmio convertido em pecúnia, que é o que foi feito aos dez servidores do Senado que mais receberam em 2017, totalizando R$ `r round(gasto_de_referencia/10^6, 0)` milhões:

**Ambulâncias do SAMU**

Em 2017, o valor de uma ambulância da SAMU em um dos modelos mais equipados custa em média R$ 150 mil. Assim, usamos esse valor de referência como o custo de uma ambulância.

Fonte:

[Dezenove ambulâncias do Samu estão paradas em galpão](http://www.otempo.com.br/cidades/dezenove-ambul%C3%A2ncias-do-samu-est%C3%A3o-paradas-em-galp%C3%A3o-1.1436254)

**Bolsas CAPES de doutorado**

Consideramos o valor da bolsa CAPES na modalidade de doutorado, o que equivale à R$ 2.200,00 por mês por aluno.

Fonte:

[Valores das bolsas da Capes no país](http://www.capes.gov.br/bolsas/valores-de-bolsas)

**Tratamento do Câncer**

De acordo com o Instituto Nacional de Câncer (INCA), o Sistema Único de Saúde (SUS) investiu R$ 3,5 bilhões no tratamento de 393 mil pacientes no ano de 2015. O montante foi investido em tratamento (cirurgias, radioterapias e quimioterapias). Assim, temos o gasto médio de R$ 8.905 por paciente, considerando a inflação acumulada dos anos de 2015 e 2016 (10,67\% e 6,29\%, respectivamente), teriamos um gasto médio de R$ 10.476 por paciente em 2017.

Fonte:

[Ministro da Saúde anuncia prioridades para a oncologia](http://www2.inca.gov.br/wps/wcm/connect/agencianoticias/site/home/noticias/2016/ministro-da-saude-anuncia-prioridades-para-a-oncologia)

[Inflação oficial fecha 2016 em 6,29%, diz IBGE](http://g1.globo.com/economia/noticia/inflacao-oficial-fecha-2016-em-629-diz-ibge.ghtml)

[Inflação oficial fica em 10,67% em 2015, a maior desde 2002](http://g1.globo.com/economia/noticia/2016/01/inflacao-oficial-fica-em-1067-em-2015.html)

**Merenda Escolar**

O Governo por meio do Programa Nacional de Alimentação Escolar (Pnae), anunciou o investimento de R$ 465 milhões a mais para beneficiar 41 milhões de estudantes de todo o país, o que dá em média R$ 11,34 por estudante.

Fonte:

[Governo anuncia reajustes para a merenda escolar](http://agenciabrasil.ebc.com.br/politica/noticia/2017-02/governo-anuncia-reajustes-para-merenda-escolar)

**Contribuição Doméstica ao INSS**

Para se aposentar, uma empregada doméstica que recebe R$ 1.500,00 deverá contribuir ao INSS com 8\% do seu salário, o que corresponde à R$ 120 ao mês.

Fonte:

[Percentuais da contribuição previdenciária (INSS) de patrões e empregados domésticos](https://www.domesticalegal.com.br/utilidades/tabela-de-inss/)

**Pavimentação em Asfalto**

De acordo com o Departamento Nacional de Infraest de Transportes (DNIT), o custo médio para construção de uma pista simples é de R$ 2.948 por metro de rodovia construída em 2014. Considerando a inflação dos anos de 2015 e 2016 (10,67\% e 6,29\%, respectivamente), teríamos um custo médio de 3.468 por metro de rodovia construída em 2017.

Fonte:

[Custos Médios Gerenciais](https://189.9.128.64/download/servicos/custo-medio-gerencial/custos-medios-ger.novembro-14.pdf)









### Aposentados

* **Quanto o Senado paga aos Aposentados?**

```{r calculo_aposentados, echo=FALSE}
aposentados_recente <- senado_recente[senado_recente$situacao=="APOSENTADO",]
aposentados_totais <- data[data$situacao=="APOSENTADO",]

receita_total_recente <- sum(senado_recente$remuneracao_total_liquida)
receita_aposentados_todos <- sum(aposentados_totais$remuneracao_total_liquida)
receita_aposentados_recente <- sum(aposentados_recente$remuneracao_total_liquida)
```

O Senado fornece dados para `r round(nrow(aposentados_totais)/10^3, 0)` mil pagamentos referentes a aposentados entre os anos de `r ano_min` e `r ano_max`. Nesse período já foi pago um total `r round(receita_aposentados_todos/10^9, 1)` bilhões de reais, o que representa `r round(receita_aposentados_todos/remuneracao_total_liquida*100, 1)`% de todos os pagamentos realizados nesse intervalo de tempo.

Só no ano de `r ano_max`, o Senado pagou `r round(receita_aposentados_recente/1000000, 1)` milhões de reais em remuneração o que representa `r round(receita_aposentados_recente/receita_total_recente*100, 1)`% do total da folha de pagamento do Senado.


```{r aposentados_graficos,fig.align='center', echo=FALSE, fig.width=3,fig.height=1}
library("ggplot2")
demais_servidores_total <- remuneracao_total_liquida-receita_aposentados_todos
demais_servidores_recente <- receita_total_recente-receita_aposentados_recente

ratio <- 10^9

df2 <- data.frame(Data=rep(c(ano_max, "Todos os Anos"), each=2),
                Situação=rep(c("Aposentados", "Demais Servidores"),2),
                Remuneração=c(receita_aposentados_recente/ratio, demais_servidores_recente/ratio, receita_aposentados_todos/ratio, demais_servidores_total/ratio))

g <- ggplot(data=df2, aes(x=Data, y=Remuneração, fill=Situação)) +
geom_bar(stat="identity", position=position_dodge(width=0.6), width=0.5) +
theme_minimal() +
  labs(title="Remuneração dos Pensionistas", 
       x="Data de Referência", y = "Remuneração em Bilhões de Reais",
       fill = "Situação")

ggplotly(g)
```

-----------------------------------------------------------------------

* **Qual a relação entre o arrecadado e o pago aos aposentados?**

```{r calculo_arrecadacao, echo=FALSE}
arrecadao_total <- sum(data$imposto_de_renda+data$psss+data$reversao)
deficit_total <- sum(aposentados_totais$remuneracao_total_liquida)+arrecadao_total

arrecadao_recente <- sum(senado_recente$imposto_de_renda+senado_recente$psss+senado_recente$reversao)
deficit_recente <- sum(aposentados_recente$remuneracao_total_liquida)+arrecadao_recente

arrecadao_inss_e_psss <- sum(data$imposto_de_renda+data$psss)
quantidade_pagamentos <- nrow(data)
```


O Senado arrecada alguns valores do próprio servidor por meio de descontos do imposto de renda e do Plano de Seguridade Social do Servidor Público (PSSS). Entre `r ano_min` e `r ano_max` foi arrecadado por meio do imposto de renda R$ `r round(sum(data$imposto_de_renda)/-10^6, 1)` milhões e por meio do PSSS cerca de R$ `r round(sum(data$psss)/-10^6, 1)` milhões, totalizando um montante de R$ `r round(arrecadao_inss_e_psss/-10^9, 1)` bilhões. Adicionalmente, foram arrecaddaos R$ `r round(sum(data$reversao)/-10^6, 1)` por meio da reversão do teto constitucional . 

Nesse mesmo intervalo de tempo (`r ano_min`-`r ano_max`), o Senado efetuou o pagamento de R$ `r round(sum(aposentados_totais$remuneracao_total_liquida)/10^9, 1)` bilhões de reais para aposentados (conforme descrito na seção anterior), mas arrecadou dos próprios servidores somente R$ `r round(arrecadao_total/10^9, 1)*(-1)` bilhões, o que significa um DÉFICIT de R$ `r round(deficit_total/10^9, 1)` bilhão. *Conclusão: A previdência do Senado não se paga.*

```{r arrecadao_graficos, fig.align='center', echo=FALSE, fig.width=5, fig.height=3}
library(ggplot2)

ratio<-10^9

df2 <- data.frame(Data=rep(c("Todos os Anos", ano_max), each=5),
                Situação=rep(c("Aposentados","PSSS","Imposto de Renda", "Déficit","Reversão"),2),
                Remuneração=c(receita_aposentados_todos/-ratio, sum(data$psss)/-ratio, sum(data$imposto_de_renda)/-ratio, deficit_total/-ratio, sum(data$reversao)/-ratio,
                              receita_aposentados_recente/-ratio, sum(senado_recente$psss)/-ratio, sum(senado_recente$imposto_de_renda)/-ratio, deficit_recente/-ratio, sum(senado_recente$reversao)/-ratio ))

g <-ggplot(data=df2, aes(x=Data, y=Remuneração, fill=Situação)) +
geom_bar(stat="identity", position=position_dodge(width=0.6), width=0.5) +
theme_minimal() +
  labs(title="Arrecadação do Senado e Aposentadoria", 
       x="Data de Referência", y = "Bilhões de Reais",
       fill = "Gastos/Arrecadação")

ggplotly(g)
```

Considerando ambas folhas de pagamento (normal e suplementar), temos:

- **Aposentados**: Corresponde a Remuneração Líquida de todos os Aposentados.
- **PSSS**: Plano de Seguridade Social do Servidor Público (PSSS) arrecadado pelo Senado descontado por todos os servidores de ambas as folhas de pagamento.
- **INSS**: Arrecadação do Senado descontado de todos os servidores de ambas as folhas de pagamento.
- **Reversão**: Corresponde ao desconto dado pelo Senado a todos os servidores que ultrapassaram o teto constitucional. 
- **Déficit**: Valor que o Senado precisaria arrecadar para equilibrar as contas: PSSS + INSS + Reversão - Aposentados.

-----------------------------------------------------------------------

* **Quais aposentados receberam os maiores valores?**

A tabela seguinte mostra os meses e os respectivos aposentados que receberam as maiores remunerações entre `r ano_min` e `r ano_max`. Os valores de remuneração apresentados correspondem à Remuneração Líquida (previamente explicada). Observe que não estamos de nenhuma forma fazendo implicações de irregularidade, estamos somente exemplificando como o acesso a esses dados pode deixar essas informaçõe mais transparentes.

```{r top_salarios_aposentados, echo=FALSE}
keeps <- c("Nome","Cargo","Especialidade","Mês","Ano","Remuneração com Desconto (R$)")
salariosAgregados <- aggregate(remuneracao_total_liquida~nome+cargo+especialidade+mes+ano, FUN=sum, aposentados_totais)
top_servidores_aposentados <- topSalarios(salariosAgregados, salariosAgregados$remuneracao_total_liquida, keeps, 10)
kable(top_servidores_aposentados)
```







  

### Licença-Prêmio

* **O que é Licença-Prêmio?**

Outro tipo de pagamento efetuado pelo Senado chama-se de Licença-Prêmio. Esse pagamento era um direito previsto para os servidores na Lei n. 8.112/90 (derivada da licença especial prevista na Lei n. 1.711/52), que determinava que a cada cinco anos ininterruptos de exercício o servidor tinha direito a três meses de licença remunerada, a título de prêmio por assiduidade.

A Medida Provisória nº 1.522, posteriormente convertida na Lei nº 9.527/97, de 11/10/1996 extinguiu a Licença-Prêmio e a transformou em Licença para Capacitação, ou seja, os servidores que ingressaram após o advento dessa lei, ou que não complementaram o quinquênio até a sua publicação, deixaram de contar com o direito à licença-prêmio e passaram a contar somente com a Licença para Capacitação.

Todavia, restou assegurando o direito adquirido à licença-prêmio para o servidor que completou o tempo necessário até 15/10/1996, ponde este servidor gozar dos períodos de licença-prêmio ou convertê-los em dobro para a aposentadoria. Ainda, em caso de falecimento do servidor, restou assegurado o pagamento em pecúnia das licenças para os seus sucessores.

Fonte:

[Servidor: Conheça os seus direitos sobre licença-prêmio (acessado em 27 de julho de 2017)](https://sindjufe-go.jusbrasil.com.br/noticias/100639807/servidor-conheca-os-seus-direitos-sobre-licenca-premio)

* **Quais são os gastos do Senado com Licença-Prêmio?**

```{r licenca_premio, echo=FALSE, fig.width=5, fig.height=3}
ratio <- 10^6

#LICENÇA PRÊMIO POR CARGO TODOS OS ANOS
salariosAgregados <- aggregate(licenca_premio_s~cargo, FUN=sum, data)
keeps <- c("cargo","remuneracao")
top_licenca_cargo_todos <- topSalarios(salariosAgregados, salariosAgregados$licenca_premio_s, keeps, 4)
top_licenca_cargo_todos$remuneracao <- top_licenca_cargo_todos$remuneracao/ratio
top_licenca_cargo_todos <- mutate(top_licenca_cargo_todos, data="Todos os Anos")

#LICENÇA PRÊMIO POR CARGO NO ANO DE REFERÊNCIA MAIS RECENTE
salariosAgregados <- aggregate(licenca_premio_s~cargo, FUN=sum, senado_recente)
keeps <- c("cargo","remuneracao")
top_licenca_cargo_recente <- topSalarios(salariosAgregados, salariosAgregados$licenca_premio_s, keeps, 4)
top_licenca_cargo_recente$remuneracao <- top_licenca_cargo_recente$remuneracao/ratio
top_licenca_cargo_recente <- mutate(top_licenca_cargo_recente, data=ano_max)

licenca_cargo_completo <- rbind(top_licenca_cargo_todos, top_licenca_cargo_recente)

beneficiados_licenca_premio <- data[data$licenca_premio_s>0,]
```

No ano de `r ano_max`, o Senado pagou cerca de R$ `r round(sum(top_licenca_cargo_recente$remuneracao), 1)` milhões de Licença-Prêmio. Sendo os cargos `r top_licenca_cargo_recente[1, ]$cargo` e `r top_licenca_cargo_recente[2, ]$cargo` que mais receberam Licença-Prêmio nesse ano, o que representa um total de R$ `r round(top_licenca_cargo_recente[1, ]$remuneracao, 1)` e R$ `r round(top_licenca_cargo_recente[2, ]$remuneracao, 1)` milhões de reais, respectivamente. Entre os anos `r ano_min` e `r ano_max`, foi pago cerca de R$ `r round(sum(top_licenca_cargo_todos$remuneracao), 1)` milhões de Licença-Prêmio (valor bruto, ou seja, sem descontos) para `r round(nrow(beneficiados_licenca_premio)/10^3, 0)` mil servidores, o que dá (em média), R$ `r round( (sum(top_licenca_cargo_todos$remuneracao)/nrow(beneficiados_licenca_premio))/10^3, 0)` mil por servidor.

```{r plot_licenca_premio, echo=FALSE, fig.width=5, fig.height=3}
g <-ggplot(data=licenca_cargo_completo, aes(x=data, y=remuneracao, fill=cargo)) +
geom_bar(stat="identity", position=position_dodge(width=0.6), width=0.5) +
theme_minimal() +
  labs(title="Pagamento de Licença Prêmio", 
       x="Período de Tempo", y = "Milhões de Reais",
       fill="Cargo")
ggplotly(g)
```

* **Quem são os servidores mais beneficiados com a Licença-Prêmio?**

Na Tabela seguinte mostramos a lista dos dez servidores que mais se beneficiaram com a Licença-Prêmio entre os anos `r ano_min` e `r ano_max` de acordo com os dados disponíveis pelo Senado. A tabela exibe os seguintes campos: 

* **Nome:** Nome completo do servidor beneficiado.
* **Cargo:** Cargo do servidor.
* **Especialidade:** Área de especialidade o do servidor.
* **Situação:** Aposentado ou não (ativo).
* **Mês e Ano:** Mês de referência do pagamento da Licença-Prêmio.
* **Ano de Admissão:** Ano em que o servidor foi contrato pelo Senado.
* **Licença-Prêmio (R$):** Valor de Licença-Prêmio em reais.

```{r top_licenca_premio, echo=FALSE, fig.width=5, fig.height=3}
keeps <- c("Nome","Cargo","Especialidade","Mês","Ano","Ano de Admissão","Licença-Prêmio* (R$)")
salariosAgregados <- aggregate(licenca_premio_s~nome+cargo+especialidade+mes+ano+ano_de_admissao, FUN=sum, data)
top_servidores_licenca_premio <- topSalarios(salariosAgregados, salariosAgregados$licenca_premio_s, keeps, 10)

kable(top_servidores_licenca_premio)
```
*Valor bruto de Licença-Prêmio (sem descontos).

### Assessores

```{r senadores_2016, echo=FALSE}
senado_2016 <- data[data$ano==2016,]

```

Além de salários e benefícios generosos, nossos senadores ainda contam com uma equipe de assessores. Até aí tudo bem, afinal é importante que haja auxílio administrativo para que nossos parlamentares possam se concentrar em tarefas mais importantes. O problema é quando o número de assessores é grande e desafia o bom senso. Abaixo mostramos o número de assessores por Senador. Como assessores consideramos: efetivos, comissionados, terceirizados, estagiários e escritório de apoio. Em todos os casos o maior número de assessores é de comissionados.


```{r assessores, echo=FALSE, cache=FALSE}
#p1 = mPlot(x = 'SENADOR', y = list('TOTAL'), data = qtde_assessores, type = 'Bar')
#p1$set(hideHover = "auto")
#p1$print('chart1', include_assets = TRUE)
qtde_assessores <- readr::read_csv(file="../../dados/assessores/qtde_assessores.csv")
qtde_assessores =  arrange(qtde_assessores,desc(TOTAL))

g <-ggplot(data=qtde_assessores, aes(x=SENADOR, y=TOTAL)) +
geom_bar(stat="identity", position=position_dodge(width=0.8), width=0.8) +
theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +
       scale_x_discrete(breaks = qtde_assessores$SENADOR[c(T, rep(F, 3))], limits = qtde_assessores$SENADOR)
ggplotly(g)

```

Na tabela abaixo mostramos o custo em 2016 dos top-3 senadores com maior número de assessores considerando somente: comissionados, efetivos e escritório de apoio. O custo total somado desses três senadores em 2016 só em assessores foi de quase R$ 12 milhões de reais!! 


```{r,echo=FALSE, include=FALSE}
qtde_assessores <- readr::read_csv(file="../../dados/assessores/qtde_assessores.csv")
top3_senadores = qtde_assessores[c(1,2,3),c(1,2,3,6)]

####################### Assessores João Alberto #######################
assessores_ja <- readr::read_csv(file="../../dados/assessores/assessores_joao_alberto.csv")
assessores_ja = assessores_ja[[2]] 
num_assessores_ja = length(assessores_ja)
num_assessores_ja
assessores_ja = filter(senado_2016, nome %in% assessores_ja) %>%
  arrange(desc(remuneracao_total_liquida))
soma_sal_ja = format(sum(assessores_ja$remuneracao_total_liquida),big.mark = '.')
dist_sal_ja = summary(assessores_ja$remuneracao_total_liquida)
####################### Assessores João Alberto #######################
assessores_col <- readr::read_csv(file="../../dados/assessores/assessores_collor.csv")
assessores_col = assessores_col[[2]] 
num_assessores_col = length(assessores_col)
num_assessores_col
assessores_col = filter(senado_2016, nome %in% assessores_col) %>%
  arrange(desc(remuneracao_total_liquida))
soma_sal_col = format(sum(assessores_col$remuneracao_total_liquida),big.mark = '.')
dist_sal_col = summary(assessores_col$remuneracao_total_liquida)
####################### Assessores Hélio José #######################
assessores_he <- readr::read_csv(file="../../dados/assessores/assessores_helio_jose.csv")
assessores_he = assessores_he[[2]] 
num_assessores_he = length(assessores_he)
num_assessores_he
assessores_he = filter(senado_2016, nome %in% assessores_he) %>%
  arrange(desc(remuneracao_total_liquida))
soma_sal_he = format(sum(assessores_he$remuneracao_total_liquida),big.mark = '.')
dist_sal_he = summary(assessores_he$remuneracao_total_liquida)

custo_assessores_2016 = c(soma_sal_ja,soma_sal_col,soma_sal_he)
media_assessores_2016 = c(dist_sal_ja[4],dist_sal_col[4],dist_sal_he[4])
top3_senadores = mutate(top3_senadores,Custo=custo_assessores_2016)
colnames(top3_senadores) = c("Senador", "Efetivos", "Comissionados", "Esc. Apoio", "Custo (R$)")

```

```{r,echo=FALSE}
kable(top3_senadores)
```

Na tabela abaixo mostramos os top-1 assessores em termos de remuneração líquida para cada um dos senadores na tabela acima.

```{r,echo=FALSE}
top1_ja = assessores_ja[1,c(2,3,55)]
top1_col = assessores_col[1,c(2,3,55)]
top1_he = assessores_he[1,c(2,3,55)]
top3_assessores = rbind(top1_ja,top1_col) %>% 
  rbind(top1_he) 
top3_assessores = cbind(top3_senadores[1],top3_assessores)
top3_assessores[,4] = format(top3_assessores[,4],big.mark = '.',decimal.mark = ',')
colnames(top3_assessores) = c("Senador","Assessor","Vínculo","Remuneração (R$)")
```

```{r,echo=FALSE}
kable(top3_assessores)
```
